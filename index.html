<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>personal-dashboard</title>
</head>
<body>
    <nav>
        <div class="nav-wrapper">
            <a href="#!" class="brand-logo">Good Morning, <div class="name"></div></a>
            <ul class="right hide-on-med-and-down">
                <li><input id="currentCity" type="search" required>
                </li>
                <li><class="material-icons left>search</id= i>Location</a></li>
                <li><a class="dropdown-trigger" href="#!" data-target="dropdown1">Dropdown<i
                            class="material-icons right">arrow_drop_down</i></a></li>
            </ul>
        </div>
    </nav>
    <div class="row">
        <div class="col s12 m9 xl9 fiveDay">
        </div>
        <div id="everydayStock" class="col s12 m3">
            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title"></span>
                    <p></p>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div id="nytNews" class="col s12 m3">
            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title"></span>
                    <p></p>
                </div>
            </div>
        </div>
        <div id="redditNews" class="col s12 m3">
            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title"></span>
                    <p></p>
                </div>
            </div>
        </div>
        <div id="mapTraffic" class="col s12 m6">
            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title"></span>
                    <p></p>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script>
        //Link to subreddits maybe in a dropdown? Add maybe 10-15 subreddits in dropdown? and limit it to top 5?
      generateCurrent();
      generateForecast();
      function generateCurrent() {
        // var userSearch = "newark"; //remove variable afterwords
        var apiKey = "f1347b661a93475fb7c664d08aaa163f";
        var queryURL =
          "https://api.weatherbit.io/v2.0/current?city=Raleigh,NC&units=I&key=" +
          apiKey;
        console.log(queryURL);
        $.ajax({
          url: queryURL,
          method: "GET"
        }).then(function(current) {
          console.log(current);
          var currentObject = current.data[0];
          $(".today").text(moment().format("dddd, MMMM Do YYYY, h:mm:ss a"));
          $(".currentCity").text(
            currentObject.city_name + ", " + currentObject.state_code
          );
          $(".currentTemp").text("Temperature: " + currentObject.temp + "° F");
          $(".currentWind").text(
            "Wind Speed: " +
              currentObject.wind_spd +
              " MPH " +
              currentObject.wind_cdir
          );
          $(".currentHumidity").text("Humidity: " + currentObject.rh + "%");
        });
      }
      function generateForecast() {
        var userSearch = "edison,nj"; //remove variable afterwords
        var apiKey = "f1347b661a93475fb7c664d08aaa163f";
        var queryURL =
          "http://api.weatherbit.io/v2.0/forecast/daily?city=" +
          userSearch +
          "&units=I&days=16&key=" +
          apiKey;
        console.log(queryURL);
        $.ajax({
          url: queryURL,
          method: "GET"
        }).then(function(forecast) {
          console.log(forecast);
          for (let i = 0; i < 5; i++) {
            var forecastObject = forecast.data[i];
            // var title = $("<h1>").addClass("card-title").text("Five Day Weather Forecast: ");
            // var biggerCard = $("<div id='container'>").addClass("card blue-grey darken-1");
            var forecastCard = $("<div>");
            var forecastDayOf = $("<p>");
            // var forecastDate = $("<p>");
            var forecastIcon = $("<img>");
            var forecastHigh = $("<p>");
            var forecastLow = $("<p>");
            var forecastDesc = $("<p>");
            // var dayOfWeek = (moment().day());
            // var dayNum = dayOfWeek + i;
            // console.log (dayNum);
            var forecastCode = forecastObject.weather.icon;
            var forecastIconCode =
              "https://www.weatherbit.io/static/img/icons/" +
              forecastCode +
              ".png"; //https://www.weatherbit.io/static/img/icons/{icon_code}.png
            forecastCard.addClass("col");
            forecastIcon.attr("src", forecastIconCode);
            forecastDayOf.text(moment()
                .add((moment().day()) + i - 1, "d")
                .format("MMMM Do"));; //returns sunday as 0, monday as 1...need to run this value through an if statement and change the text accordingly
            forecastHigh.text("High: " + forecastObject.high_temp + "° F");
            forecastLow.text("Low: " + forecastObject.low_temp + "° F");
            forecastDesc.text(forecastObject.weather.description);
            forecastCard.append(
              forecastDayOf,
              forecastIcon,
              forecastHigh,
              forecastLow,
              forecastDesc
            );
            $(".fiveDay").append(forecastCard);
            // $("#container").append(
            //     title,
            //     forecastCard)
            // $(".fiveDay").append(biggerCard);
          }
        });
      }
    </script>
</body>
</html>